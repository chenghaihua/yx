<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>商品列表</title>
    <meta name="viewport" content="width=device-width,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no"/>
    <meta name="format-detection" content="telephone=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="stylesheet" href="css/buy.css">
    <script src="js/adaptation.js"></script>
</head>
<body style="background:#f0f0f0;overflow:hidden;">
<section class="header">
    <div>
        <a href="">45#</a><a href="">20rMnTiH</a><a href="">45#</a><a href="">20rMnTiH</a><a href="">45#</a><a href="">20rMnTiH</a>
    </div>
    <div>
        <span>钢种</span><span>规格</span><span>钢厂</span><span>长度</span><span>数量</span>
    </div>
</section>
<section class="list-con" id="wrapper">
    <div id="scroller">
        <div id="pullDown" class=""><div class="pullDownLabel"></div></div>
        <div class="pulldown-tips">下拉刷新</div>
        <ul id="list">
            <li>
                <div>
                    <span>20rMnTiH</span><span>Ф800</span><span>杭钢</span><span>1米</span><span>100吨</span>
                </div>
                <div>
                    <span>2900元/吨</span><i>浙江杭州</i><a href="javascript:void(0);">加入采购清单</a>
                </div>
            </li>
            <li>
                <div>
                    <span>20rMnTiH</span><span>Ф800</span><span>杭钢</span><span>1米</span><span>100吨</span>
                </div>
                <div>
                    <span>2900元/吨</span><i>浙江杭州</i><a href="javascript:void(0);">加入采购清单</a>
                </div>
            </li>
            <li>
                <div>
                    <span>20rMnTiH</span><span>Ф800</span><span>杭钢</span><span>1米</span><span>100吨</span>
                </div>
                <div>
                    <span>2900元/吨</span><a href="javascript:void(0);">加入采购清单</a>
                </div>
            </li>
            <li>
                <div>
                    <span>20rMnTiH</span><span>Ф800</span><span>杭钢</span><span>1米</span><span>100吨</span>
                </div>
                <div>
                    <span>2900元/吨</span><a href="javascript:void(0);">加入采购清单</a>
                </div>
            </li>
            <li>
                <div>
                    <span>20rMnTiH</span><span>Ф800</span><span>杭钢</span><span>1米</span><span>100吨</span>
                </div>
                <div>
                    <span>2900元/吨</span><a href="javascript:void(0);">加入采购清单</a>
                </div>
            </li>
            <li>
                <div>
                    <span>20rMnTiH</span><span>Ф800</span><span>杭钢</span><span>1米</span><span>100吨</span>
                </div>
                <div>
                    <span>2900元/吨</span><a href="javascript:void(0);">加入采购清单</a>
                </div>
            </li>
            <li>
                <div>
                    <span>20rMnTiH</span><span>Ф800</span><span>杭钢</span><span>1米</span><span>100吨</span>
                </div>
                <div>
                    <span>2900元/吨</span><a href="javascript:void(0);">加入采购清单</a>
                </div>
            </li>
            <li>
                <div>
                    <span>20rMnTiH</span><span>Ф800</span><span>杭钢</span><span>1米</span><span>100吨</span>
                </div>
                <div>
                    <span>2900元/吨</span><a href="javascript:void(0);">加入采购清单</a>
                </div>
            </li>
            <li>
                <div>
                    <span>20rMnTiH</span><span>Ф800</span><span>杭钢</span><span>1米</span><span>100吨</span>
                </div>
                <div>
                    <span>2900元/吨</span><a href="javascript:void(0);">加入采购清单</a>
                </div>
            </li>
            <li>
                <div>
                    <span>20rMnTiH</span><span>Ф800</span><span>杭钢</span><span>1米</span><span>100吨</span>
                </div>
                <div>
                    <span>2900元/吨</span><a href="javascript:void(0);">加入采购清单</a>
                </div>
            </li>
            <li>
                <div>
                    <span>20rMnTiH</span><span>Ф800</span><span>杭钢</span><span>1米</span><span>100吨</span>
                </div>
                <div>
                    <span>2900元/吨</span><a href="javascript:void(0);">加入采购清单</a>
                </div>
            </li>
            <li>
                <div>
                    <span>20rMnTiH</span><span>Ф800</span><span>杭钢</span><span>1米</span><span>100吨</span>
                </div>
                <div>
                    <span>2900元/吨</span><a href="javascript:void(0);">加入采购清单</a>
                </div>
            </li>
            <li>
                <div>
                    <span>20rMnTiH</span><span>Ф800</span><span>杭钢</span><span>1米</span><span>100吨</span>
                </div>
                <div>
                    <span>2900元/吨</span><a href="javascript:void(0);">加入采购清单</a>
                </div>
            </li>
        </ul>
        <div id="pullUp" class="">
            <div class="pullUpLabel">加载更多</div>
        </div>
    </div>
</section>
<script src="js/jquery-3.1.1.min.js"></script>
<script src="js/iscroll-probe.js"></script>
<script>
   /* $(function(){
       $(".list-con").on("click",'a',function(){
           var span=$(this).closest("div").siblings("div").find("span");
           var _self=$(this);

           var price=parseFloat($(this).siblings("span").html());
           var gz=span.eq(0).html();
           var gg=span.eq(1).html();
           var gc=span.eq(2).html();
           var sl=span.eq(3).html();

           $(this)[0].dataset.itrue=true;

            if($(this).data("itrue")){
                $.post("",{},function(data){
                    _self.addClass("active");
                    _self[0].dataset.itrue=false;
                },"json");
            }

       });

    });*/
    load();
    function load () {
        var myScroll,
                pullDown = $("#pullDown"),
                pullUp = $("#pullUp"),
                pullDownLabel = $(".pullDownLabel"),
                pullUpLabel = $(".pullUpLabel"),
                container = $('#list'),
                loadingStep = 0;//加载状态0默认，1显示加载状态，2执行加载数据，只有当为0时才能再次加载，这是防止过快拉动刷新

        pullDown.hide();
        pullUp.hide();
        myScroll = new IScroll("#wrapper", {
            scrollbars: true,
            mouseWheel: false,
            interactiveScrollbars: true,
            shrinkScrollbars: 'scale',
            fadeScrollbars: true,
            scrollY:true,
            probeType: 2,
            bindToWrapper:true
        });
        myScroll.on("scroll",function(){
            if(loadingStep == 0 && !pullDown.attr("class").match('refresh|loading') && !pullUp.attr("class").match('refresh')){
                if(this.y > 40){//下拉刷新操作
                    $(".pulldown-tips").hide();
                    pullDown.addClass("refresh").show();
                    pullDownLabel.text("松手刷新数据");
                    loadingStep = 1;
                    myScroll.refresh();
                }else if(this.y < (this.maxScrollY - 14)){//上拉加载更多
                    pullUp.addClass("refresh").show();
                    pullUpLabel.text("正在载入");
                    loadingStep = 1;
                    pullUpAction();
                }
            }
        });
        myScroll.on("scrollEnd",function(){
            if(loadingStep == 1){
                if( pullDown.attr("class").match("refresh") ){//下拉刷新操作
                    pullDown.removeClass("refresh").addClass("loading");
                    pullDownLabel.text("正在刷新");
                    loadingStep = 2;
                    pullDownAction();
                }
            }
        });

        function pullDownAction(){
            pullDown.attr('class','').hide();
            myScroll.refresh();
            loadingStep = 0;
            $(".pulldown-tips").show();
        }
        function pullUpAction(){
            /*var li, i;
            for (i = 0,li = ""; i < 3; i++) {
                li += "<li>" + "new Add " + new Date().toLocaleString() + " ！" + "</li>";
            }*/
            setTimeout(function(){
                var li="";
                for(var i=0;i<10;i++){
                    li+='<li>'+
                            '<div>' +
                            '<span>20rMnTiH</span>' +
                            '<span>Ф800</span>' +
                            '<span>杭钢</span>' +
                            '<span>1米</span>' +
                            '<span>100吨</span>' +
                            '</div>' +
                            '<div>' +
                            '<span>2900元/吨</span>' +
                            '<a href="javascript:void(0);">加入采购清单</a>' +
                            '</div>' +
                            '</li>'
                }
                container.append(li);
                pullUp.attr('class','').hide();
                myScroll.refresh();
                loadingStep = 0;
            },300);
        }

        document.addEventListener('touchmove', function (e) { e.preventDefault(); }, false);
    }
</script>
</body>
</html>